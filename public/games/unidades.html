<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üß™ Laborat√≥rio de Unidades</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,sans-serif;background:#0b1220;color:#e2e8f0;display:flex;justify-content:center;min-height:100dvh}
    .app{width:min(820px,100%);padding:18px}.card{background:#111a2c;border:1px solid #24324d;border-radius:18px;padding:16px}
    h1{font-size:1.3rem}.muted{color:#93a4c2;font-size:.9rem;margin-top:4px}
    .tabs{display:flex;gap:10px;margin-top:14px}.tab{background:#17233a;border:1px solid #2e3f5f;color:#fecdd3;padding:10px 14px;border-radius:10px;font-weight:800;cursor:pointer}
    .tab.active{background:linear-gradient(135deg,#f43f5e,#be123c);color:#fff;border-color:#f43f5e}
    .hidden{display:none!important}.section{margin-top:16px}
    .study-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:10px}
    .item{background:#15233a;border:1px solid #2b3d5c;border-radius:12px;padding:12px}
    .title{font-weight:800;color:#fda4af}.desc{margin-top:6px;color:#cbd5e1;font-size:.9rem;line-height:1.45}
    .row{display:flex;gap:10px;flex-wrap:wrap}.pill{background:#1a2740;border:1px solid #2c3b58;border-radius:999px;padding:6px 10px;font-size:.85rem}
    .question{margin-top:14px;font-size:1.05rem;font-weight:700}.options{display:grid;gap:10px;margin-top:12px}
    .opt{background:#17233a;border:1px solid #2e3f5f;color:#e2e8f0;padding:12px;border-radius:10px;text-align:left;font-weight:700;cursor:pointer}
    .ok{background:#123524;border-color:#22c55e}.bad{background:#3a1b23;border-color:#ef4444}
    .feedback{margin-top:10px;color:#fecdd3;font-size:.92rem}.next{margin-top:12px;width:100%;padding:12px;border:0;border-radius:10px;background:#f43f5e;color:#fff;font-weight:800;cursor:pointer}
  </style>
</head>
<body>
<div class="app"><div class="card">
  <h1>üß™ Laborat√≥rio de Unidades</h1>
  <p class="muted">Matem√°tica 9+ ‚Ä¢ medidas e convers√µes no dia a dia</p>
  <div class="tabs"><button class="tab active" id="studyBtn">üìö Estudo</button><button class="tab" id="quizBtn">üß† Jogo</button></div>

  <section class="section" id="studySec"><div class="study-grid" id="studyGrid"></div></section>

  <section class="section hidden" id="quizSec">
    <div id="quizWrap">
      <div class="row">
        <div class="pill">Pergunta: <span id="qnum">1</span>/<span id="qtotal">14</span></div>
        <div class="pill">Pontos: <span id="score">0</span></div>
        <div class="pill">Tempo: <span id="time">180</span>s</div>
      </div>
      <div class="question" id="question"></div>
      <div class="options" id="options"></div>
      <div class="feedback" id="feedback"></div>
      <button class="next hidden" id="nextBtn">Pr√≥xima ‚ñ∂</button>
    </div>
  </section>
</div></div>
<script>
const STUDY=[
 {t:'Comprimento',d:'1 m = 100 cm ‚Ä¢ 1 km = 1000 m ‚Ä¢ 1 cm = 10 mm'},
 {t:'Massa',d:'1 kg = 1000 g ‚Ä¢ 1 g = 1000 mg'},
 {t:'Volume/Capacidade',d:'1 L = 1000 mL ‚Ä¢ 250 mL = 0,25 L ‚Ä¢ 500 mL = 0,5 L'},
 {t:'Tempo',d:'1 h = 60 min ‚Ä¢ 1 min = 60 s ‚Ä¢ 1 dia = 24 h'},
 {t:'Dica',d:'No quiz, os valores mudam a cada partida. Leia com aten√ß√£o!'}
];

const TOTAL_QUESTIONS = 14;
const rnd=(a,b)=>Math.floor(Math.random()*(b-a+1))+a;
const shuffle=(arr)=>[...arr].sort(()=>Math.random()-0.5);

function genQuestion(){
  const types = [
    ()=>{ const m=rnd(2,25); const ans=m*100; return {q:`Quantos cent√≠metros existem em ${m} metros?`,a:`${ans} cm`,w:[`${ans/10} cm`,`${ans*10} cm`,`${m} cm`],exp:`${m} √ó 100 = ${ans}.`}; },
    ()=>{ const km=rnd(2,40); const ans=km*1000; return {q:`${km} km equivalem a quantos metros?`,a:`${ans} m`,w:[`${km*100} m`,`${ans/10} m`,`${ans*10} m`],exp:`${km} √ó 1000 = ${ans}.`}; },
    ()=>{ const kg=rnd(1,12); const ans=kg*1000; return {q:`${kg} kg correspondem a quantos gramas?`,a:`${ans} g`,w:[`${kg*100} g`,`${ans/10} g`,`${ans*10} g`],exp:`1 kg = 1000 g.`}; },
    ()=>{ const ml=[250,300,400,500,750,900][rnd(0,5)]; const ans=(ml/1000).toString().replace('.',','); return {q:`${ml} mL s√£o quantos litros?`,a:`${ans} L`,w:[`${ml/100} L`.replace('.',','),`${ml} L`,`${(ml/10000).toString().replace('.',',')} L`],exp:`${ml} √∑ 1000 = ${ans} L.`}; },
    ()=>{ const h=rnd(2,8); const ans=h*60; return {q:`Quantos minutos h√° em ${h} horas?`,a:`${ans} min`,w:[`${h*30} min`,`${ans+10} min`,`${ans-10} min`],exp:`${h} √ó 60 = ${ans}.`}; },
    ()=>{ const min=rnd(2,10); const ans=min*60; return {q:`${min} minutos equivalem a quantos segundos?`,a:`${ans} s`,w:[`${min*100} s`,`${ans/2} s`,`${ans+30} s`],exp:`${min} √ó 60 = ${ans}.`}; },
    ()=>{ const l=[2,3,4,5][rnd(0,3)]; const ans=l*1000; return {q:`Uma garrafa de ${l} L tem quantos mL?`,a:`${ans} mL`,w:[`${l*100} mL`,`${ans/10} mL`,`${ans*10} mL`],exp:`1 L = 1000 mL.`}; },
    ()=>{ const g=[250,500,750][rnd(0,2)]; const ans=(g/1000).toString().replace('.',','); return {q:`${g} g equivalem a quantos kg?`,a:`${ans} kg`,w:[`${g/100} kg`.replace('.',','),`${g} kg`,`${(g/10000).toString().replace('.',',')} kg`],exp:`${g} √∑ 1000 = ${ans} kg.`}; },
    ()=>{ const h=rnd(1,5), m=[10,15,20,30,45][rnd(0,4)]; const ans=h*60+m; return {q:`Um filme dura ${h}h${m}. Quantos minutos s√£o?`,a:`${ans} min`,w:[`${h*60} min`,`${ans+20} min`,`${ans-15} min`],exp:`${h}h = ${h*60} min; + ${m} = ${ans}.`}; },
    ()=>{ const cm=rnd(3,90); const ans=cm*10; return {q:`${cm} cm equivalem a quantos mil√≠metros?`,a:`${ans} mm`,w:[`${cm} mm`,`${cm*100} mm`,`${ans/10} mm`],exp:`1 cm = 10 mm.`}; }
  ];
  const t = types[rnd(0,types.length-1)]();
  const opts = shuffle([t.a,...shuffle(t.w).slice(0,3)]);
  return {...t, opts, ans: opts.indexOf(t.a)};
}

let QUESTIONS = [];
let i=0,s=0,t=180,lock=false,int=null;const $=id=>document.getElementById(id);
function renderStudy(){const g=$('studyGrid');g.innerHTML='';STUDY.forEach(e=>{const c=document.createElement('div');c.className='item';c.innerHTML=`<div class='title'>${e.t}</div><div class='desc'>${e.d}</div>`;g.appendChild(c)})}
function tab(m){$('studySec').classList.toggle('hidden',m!=='study');$('quizSec').classList.toggle('hidden',m!=='quiz');$('studyBtn').classList.toggle('active',m==='study');$('quizBtn').classList.toggle('active',m==='quiz')}
function q(){const cur=QUESTIONS[i];$('qnum').textContent=i+1;$('qtotal').textContent=QUESTIONS.length;$('score').textContent=s;$('question').textContent=cur.q;$('feedback').textContent='';$('nextBtn').classList.add('hidden');lock=false;const o=$('options');o.innerHTML='';cur.opts.forEach((op,idx)=>{const b=document.createElement('button');b.className='opt';b.textContent=op;b.onclick=()=>a(idx);o.appendChild(b)})}
function a(idx){if(lock)return;lock=true;const cur=QUESTIONS[i],btns=$('options').children;if(idx===cur.ans){btns[idx].classList.add('ok');s+=10;$('feedback').textContent='‚úÖ '+cur.exp}else{btns[idx].classList.add('bad');btns[cur.ans].classList.add('ok');$('feedback').textContent='‚ùå '+cur.exp}$('nextBtn').classList.remove('hidden');if(i===QUESTIONS.length-1){$('nextBtn').textContent='Finalizar üèÅ'}}
function next(){if(i<QUESTIONS.length-1){i++;q();return}end()}
function startTimer(){clearInterval(int);int=setInterval(()=>{t--;$('time').textContent=t;if(t<=0)end()},1000)}
function end(){clearInterval(int);const final=s+Math.max(0,t);$('quizWrap').innerHTML=`<div style='text-align:center;padding:18px'><h1>üèÜ Laborat√≥rio conclu√≠do</h1><p class='muted' style='margin-top:8px'>Pontos base: ${s} ‚Ä¢ b√¥nus tempo: ${Math.max(0,t)}</p><div style='font-size:2.1rem;font-weight:800;margin-top:10px;color:#fda4af'>${final} pontos</div><button class='next' style='margin-top:14px' onclick='location.reload()'>Jogar novamente</button></div>`;window.parent.postMessage({type:'game-score',game:'unidades',score:final},'*')}
function init(){QUESTIONS = Array.from({length: TOTAL_QUESTIONS}, ()=>genQuestion()); i=0;s=0;t=180; $('score').textContent='0'; $('time').textContent='180'; q(); startTimer();}
$('studyBtn').onclick=()=>tab('study');$('quizBtn').onclick=()=>tab('quiz');$('nextBtn').onclick=next;
renderStudy();init();
</script>
</body>
</html>