<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üîç Detetive da Ortografia</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
    body { font-family: 'Poppins', sans-serif; }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(234, 179, 8, 0.5); }
      50% { box-shadow: 0 0 40px rgba(234, 179, 8, 0.8); }
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .shake { animation: shake 0.4s; }
    .pulse-glow { animation: pulse-glow 0.6s; }
    .float { animation: float 2s ease-in-out infinite; }
    .fade-in { animation: fadeIn 0.3s ease-out; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 min-h-screen flex items-center justify-center p-4">
  
  <!-- Tela Inicial -->
  <div id="startScreen" class="bg-slate-800 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center border-4 border-yellow-500">
    <div class="text-7xl mb-4 float">üîç</div>
    <h1 class="text-4xl font-bold text-yellow-400 mb-2">Detetive da Ortografia</h1>
    <p class="text-slate-300 mb-6">Resolva o caso encontrando a grafia correta!</p>
    
    <div class="bg-slate-700 rounded-lg p-4 mb-6 text-left">
      <p class="text-yellow-400 font-semibold mb-2">üìã Como Jogar:</p>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>‚Ä¢ Leia a frase com aten√ß√£o</li>
        <li>‚Ä¢ Escolha a palavra escrita corretamente</li>
        <li>‚Ä¢ Colete 10 pistas para resolver o caso!</li>
      </ul>
    </div>
    
    <button onclick="startGame()" class="bg-yellow-500 hover:bg-yellow-600 text-slate-900 font-bold py-4 px-8 rounded-xl text-xl transition-all transform hover:scale-105">
      Iniciar Investiga√ß√£o üïµÔ∏è
    </button>
  </div>

  <!-- Tela do Jogo -->
  <div id="gameScreen" class="hidden bg-slate-800 rounded-2xl shadow-2xl p-6 max-w-2xl w-full border-4 border-yellow-500">
    <!-- Header -->
    <div class="mb-6">
      <div class="flex justify-between items-center mb-3">
        <div class="flex items-center gap-2">
          <span class="text-3xl">üîç</span>
          <div>
            <div class="text-yellow-400 font-bold text-lg">Caso em Andamento</div>
            <div class="text-slate-400 text-sm">Pistas: <span id="clueCount" class="text-yellow-300 font-semibold">0/10</span></div>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <div class="text-yellow-300 font-bold">‚è± <span id="timeDisplay">120</span>s</div>
          <div id="comboDisplay" class="text-2xl font-bold text-green-400"></div>
          <button onclick="exitGame()" class="text-slate-400 hover:text-yellow-400 transition-colors text-sm font-semibold">
            ‚ùå Sair
          </button>
        </div>
      </div>
      <!-- Barra de progresso -->
      <div class="bg-slate-600 rounded-full h-3 overflow-hidden">
        <div id="progressBar" class="bg-gradient-to-r from-yellow-500 to-yellow-300 h-full transition-all duration-500" style="width: 0%"></div>
      </div>
    </div>

    <!-- Frase do Contexto -->
    <div id="sentenceCard" class="bg-gradient-to-r from-slate-700 to-slate-600 rounded-xl p-6 mb-6 border-2 border-slate-500">
      <p class="text-slate-400 text-sm mb-2">üìù Contexto da investiga√ß√£o:</p>
      <p id="sentenceText" class="text-white text-lg leading-relaxed"></p>
    </div>

    <!-- Pergunta -->
    <div class="bg-slate-700 rounded-xl p-6 mb-4">
      <p class="text-yellow-400 font-semibold mb-4">ü§î Qual √© a grafia correta?</p>
      <div id="optionsContainer" class="space-y-3"></div>
    </div>

    <!-- Feedback -->
    <div id="feedback" class="text-center font-semibold text-lg min-h-8"></div>
  </div>

  <!-- Tela Final -->
  <div id="endScreen" class="hidden bg-slate-800 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center border-4 border-yellow-500">
    <div class="text-7xl mb-4">üéâ</div>
    <h2 class="text-4xl font-bold text-yellow-400 mb-2">Caso Resolvido!</h2>
    <p class="text-slate-300 mb-6" id="endMessage">Parab√©ns, detetive!</p>
    
    <div class="bg-slate-700 rounded-lg p-6 mb-6">
      <div class="grid grid-cols-2 gap-4 text-center">
        <div>
          <div class="text-3xl font-bold text-green-400" id="correctCount">-</div>
          <div class="text-slate-400 text-sm">Acertos</div>
        </div>
        <div>
          <div class="text-3xl font-bold text-red-400" id="wrongCount">-</div>
          <div class="text-slate-400 text-sm">Erros</div>
        </div>
      </div>
      <div class="mt-4 pt-4 border-t border-slate-600">
        <div class="text-4xl font-bold text-yellow-400" id="accuracyPercent">-</div>
        <div class="text-slate-400 text-sm">Precis√£o</div>
      </div>
    </div>
    
    <button onclick="startGame()" class="bg-yellow-500 hover:bg-yellow-600 text-slate-900 font-bold py-4 px-8 rounded-xl text-xl transition-all transform hover:scale-105">
      Nova Investiga√ß√£o üîç
    </button>
  </div>

  <script>
    // Base de perguntas (ortografia comum em portugu√™s)
    const questions = [
      { sentence: "Ele tomou o caf√© da manh√£ com muita ____.", word: "pressa", options: ["pressa", "pre√ßa"], rule: "SS/√á" },
      { sentence: "A professora ____ a li√ß√£o no quadro.", word: "explicou", options: ["esplicou", "explicou"], rule: "X/S" },
      { sentence: "O ____ estava lotado de passageiros.", word: "√¥nibus", options: ["√¥nibus", "onibus"], rule: "Acentua√ß√£o" },
      { sentence: "Preciso ____ minha li√ß√£o de casa.", word: "fazer", options: ["fazer", "faser"], rule: "Z/S" },
      { sentence: "O ____ da floresta √© muito importante.", word: "ecossistema", options: ["ecosistema", "ecossistema"], rule: "SS/S" },
      { sentence: "Ela ____ na competi√ß√£o de nata√ß√£o.", word: "excelente", options: ["ecelente", "excelente"], rule: "X/EC" },
      { sentence: "Vou ____ um presente para meu amigo.", word: "escolher", options: ["escolher", "escoier"], rule: "LH/I" },
      { sentence: "O ____ est√° muito quente hoje.", word: "ch√°", options: ["ch√°", "x√°"], rule: "CH/X" },
      { sentence: "A ____ do problema foi encontrada.", word: "solu√ß√£o", options: ["solu√ß√£o", "solu√ßao"], rule: "Acentua√ß√£o" },
      { sentence: "Ele fez uma ____ na parede.", word: "exce√ß√£o", options: ["exce√ß√£o", "excess√£o"], rule: "√á/SS" },
      { sentence: "O ____ do time foi decisivo.", word: "desempenho", options: ["desempenho", "desempeno"], rule: "NH/N" },
      { sentence: "Preciso ____ minhas responsabilidades.", word: "assumir", options: ["asumir", "assumir"], rule: "SS/S" },
      { sentence: "A m√∫sica tem um ____ agrad√°vel.", word: "ritmo", options: ["ritimo", "ritmo"], rule: "TM/TIM" },
      { sentence: "Ela mora ____ da pra√ßa.", word: "pr√≥ximo", options: ["pr√≥ximo", "proximo"], rule: "Acentua√ß√£o" },
      { sentence: "O ____ foi delicioso.", word: "jantar", options: ["jantar", "gianta"], rule: "J/G" },
      { sentence: "Vou ____ um livro na biblioteca.", word: "pegar", options: ["pegar", "pejar"], rule: "G/J" },
      { sentence: "A ____ est√° muito alta.", word: "temperatura", options: ["tenperatura", "temperatura"], rule: "M/N" },
      { sentence: "Ele tem ____ de aprender.", word: "vontade", options: ["vontade", "vontadi"], rule: "DE/DI" },
      { sentence: "O ____ do rio √© cristalino.", word: "a√ßude", options: ["a√ßude", "asude"], rule: "√á/S" },
      { sentence: "Preciso ____ para o teste.", word: "estudar", options: ["estudar", "studar"], rule: "E/Omiss√£o" },
      { sentence: "A ____ √© fundamental na amizade.", word: "confian√ßa", options: ["confiansa", "confian√ßa"], rule: "√á/S" },
      { sentence: "O cachorro ____ muito alto.", word: "latiu", options: ["latiu", "latio"], rule: "U/O" },
      { sentence: "Ela ____ uma hist√≥ria incr√≠vel.", word: "contou", options: ["conto", "contou"], rule: "U/O" },
      { sentence: "O ____ do filme foi emocionante.", word: "final", options: ["final", "finar"], rule: "L/R" },
      { sentence: "Ela fez a ____ do bolo com cuidado.", word: "receita", options: ["receita", "reseita"], rule: "C/S" },
      { sentence: "O menino guardou tudo na ____.", word: "mochila", options: ["mochila", "moschila"], rule: "CH/SCH" },
      { sentence: "Vamos ao ____ comprar frutas.", word: "mercado", options: ["mercado", "mergado"], rule: "C/G" },
      { sentence: "A ____ estava limpa e organizada.", word: "cozinha", options: ["cozinha", "cosinha"], rule: "Z/S" },
      { sentence: "Ele perdeu a ____ de matem√°tica.", word: "prova", options: ["prova", "pr√≥va"], rule: "Acentua√ß√£o" },
      { sentence: "A ____ tocou antes do recreio.", word: "campainha", options: ["campainha", "canpainha"], rule: "M/N" },
      { sentence: "Ela comprou uma ____ nova.", word: "camiseta", options: ["camiseta", "camizeta"], rule: "S/Z" },
      { sentence: "O ____ atravessou a rua correndo.", word: "cachorro", options: ["cachorro", "caxorro"], rule: "CH/X" },
      { sentence: "Precisamos de ____ para a reda√ß√£o.", word: "criatividade", options: ["criatividade", "criatividede"], rule: "DA/DE" },
      { sentence: "Ele teve uma ____ excelente na prova.", word: "pontua√ß√£o", options: ["pontua√ß√£o", "pontuass√£o"], rule: "√á/SS" },
      { sentence: "A ____ estava azul e sem nuvens.", word: "paisagem", options: ["paisagem", "paisajem"], rule: "G/J" }
    ];

    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let combo = 0;
    let correctAnswers = 0;
    let wrongAnswers = 0;
    let timeLeft = 120;
    let timer = null;
    const TOTAL_QUESTIONS = 15;

    function shuffleArray(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function startGame() {
      // Reset
      score = 0;
      combo = 0;
      correctAnswers = 0;
      wrongAnswers = 0;
      currentQuestionIndex = 0;
      
      // Selecionar 10 perguntas aleat√≥rias
      currentQuestions = shuffleArray(questions).slice(0, TOTAL_QUESTIONS);
      
      // Mostrar tela do jogo
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('endScreen').classList.add('hidden');
      document.getElementById('gameScreen').classList.remove('hidden');

      timeLeft = 120;
      document.getElementById('timeDisplay').textContent = timeLeft;
      if (timer) clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        document.getElementById('timeDisplay').textContent = Math.max(0, timeLeft);
        if (timeLeft <= 0) endGame(true);
      }, 1000);
      
      loadQuestion();
    }

    function loadQuestion() {
      if (currentQuestionIndex >= TOTAL_QUESTIONS) {
        endGame();
        return;
      }

      const q = currentQuestions[currentQuestionIndex];
      const sentenceCard = document.getElementById('sentenceCard');
      const sentenceText = document.getElementById('sentenceText');
      const optionsContainer = document.getElementById('optionsContainer');
      const feedback = document.getElementById('feedback');
      const clueCount = document.getElementById('clueCount');

      // Limpar feedback
      feedback.textContent = '';
      feedback.className = 'text-center font-semibold text-lg min-h-8';
      sentenceCard.className = 'bg-gradient-to-r from-slate-700 to-slate-600 rounded-xl p-6 mb-6 border-2 border-slate-500';

      // Atualizar contador de pistas
      clueCount.textContent = `${currentQuestionIndex}/${TOTAL_QUESTIONS}`;
      
      // Atualizar barra de progresso
      const progressBar = document.getElementById('progressBar');
      const progress = (currentQuestionIndex / TOTAL_QUESTIONS) * 100;
      progressBar.style.width = `${progress}%`;

      // Mostrar frase
      const sentenceWithBlank = q.sentence.replace('____', '<span class="text-yellow-400 font-bold">____</span>');
      sentenceText.innerHTML = sentenceWithBlank;

      // Embaralhar op√ß√µes
      const shuffledOptions = shuffleArray(q.options);

      // Criar bot√µes de op√ß√£o
      optionsContainer.innerHTML = '';
      shuffledOptions.forEach(option => {
        const btn = document.createElement('button');
        btn.textContent = option;
        btn.className = 'w-full bg-slate-600 hover:bg-slate-500 text-white font-semibold py-4 px-6 rounded-lg transition-all text-xl';
        btn.onclick = () => checkAnswer(option, q.word, btn);
        optionsContainer.appendChild(btn);
      });

      // Atualizar combo display
      updateComboDisplay();
    }

    function checkAnswer(selected, correct, btnElement) {
      const feedback = document.getElementById('feedback');
      const sentenceCard = document.getElementById('sentenceCard');
      const allButtons = document.querySelectorAll('#optionsContainer button');
      const q = currentQuestions[currentQuestionIndex];

      // Desabilitar todos os bot√µes
      allButtons.forEach(btn => btn.disabled = true);

      if (selected === correct) {
        // Resposta correta
        correctAnswers++;
        combo++;
        btnElement.className = 'w-full bg-green-500 text-white font-semibold py-4 px-6 rounded-lg text-xl pulse-glow';
        feedback.textContent = getCorrectFeedback();
        feedback.className = 'text-center font-semibold text-lg text-green-400';
        sentenceCard.className = 'bg-gradient-to-r from-green-900 to-green-800 rounded-xl p-6 mb-6 border-2 border-green-500';
      } else {
        // Resposta errada
        wrongAnswers++;
        combo = 0;
        btnElement.className = 'w-full bg-red-500 text-white font-semibold py-4 px-6 rounded-lg text-xl shake';
        
        // Destacar resposta correta
        allButtons.forEach(btn => {
          if (btn.textContent === correct) {
            btn.className = 'w-full bg-green-500 text-white font-semibold py-4 px-6 rounded-lg text-xl pulse-glow';
          }
        });
        
        feedback.innerHTML = `${getWrongFeedback()}<br><span class="text-yellow-300 text-sm">üìö Regra: ${q.rule}</span>`;
        feedback.className = 'text-center font-semibold text-lg text-red-400';
        sentenceCard.className = 'bg-gradient-to-r from-red-900 to-red-800 rounded-xl p-6 mb-6 border-2 border-red-500 shake';
      }

      updateComboDisplay();

      // Pr√≥xima pergunta ap√≥s delay
      setTimeout(() => {
        currentQuestionIndex++;
        loadQuestion();
      }, 1500);
    }

    function updateComboDisplay() {
      const comboDisplay = document.getElementById('comboDisplay');
      if (combo >= 2) {
        const emoji = combo >= 5 ? 'üî•üî•' : combo >= 3 ? 'üî•' : '‚ú®';
        comboDisplay.textContent = `${emoji} ${combo}x Combo!`;
        comboDisplay.className = combo >= 5 ? 'text-2xl font-bold text-orange-400 fade-in' : 'text-2xl font-bold text-green-400 fade-in';
      } else {
        comboDisplay.textContent = '';
        comboDisplay.className = '';
      }
    }

    function exitGame() {
      if (confirm('Deseja sair da investigaÔøΩÔøΩo atual? O progresso serÔøΩ perdido.')) {
        if (timer) { clearInterval(timer); timer = null; }
        document.getElementById('gameScreen').classList.add('hidden');
        document.getElementById('startScreen').classList.remove('hidden');
      }
    }

    function getCorrectFeedback() {
      const messages = [
        "üéØ Excelente dedu√ß√£o, detetive!",
        "‚ú® Perfeito! Pista coletada!",
        "üîç Muito bem! Continue assim!",
        "‚≠ê Correto! Voc√™ est√° no caminho certo!",
        "üèÜ Brilhante! Mais uma pista!"
      ];
      return messages[Math.floor(Math.random() * messages.length)];
    }

    function getWrongFeedback() {
      const messages = [
        "‚ùå Quase l√°! Continue investigando...",
        "üîé Ops! Aten√ß√£o aos detalhes!",
        "üí≠ N√£o desista, detetive!",
        "üìù Revise e tente novamente!",
        "ü§î Hmm, essa foi dif√≠cil!"
      ];
      return messages[Math.floor(Math.random() * messages.length)];
    }

    function endGame(timeout = false) {
      if (timer) { clearInterval(timer); timer = null; }
      const accuracy = Math.round((correctAnswers / TOTAL_QUESTIONS) * 100);
      
      document.getElementById('gameScreen').classList.add('hidden');
      document.getElementById('endScreen').classList.remove('hidden');
      
      document.getElementById('correctCount').textContent = correctAnswers;
      document.getElementById('wrongCount').textContent = wrongAnswers;
      document.getElementById('accuracyPercent').textContent = accuracy + '%';
      
      let message = '';
      if (accuracy === 100) {
        message = 'üåü Detetive perfeito! Caso resolvido com maestria!';
      } else if (accuracy >= 80) {
        message = 'üéñÔ∏è Excelente trabalho, detetive! Quase perfeito!';
      } else if (accuracy >= 60) {
        message = 'üëè Bom trabalho! Continue praticando!';
      } else {
        message = 'üí™ Continue treinando, detetive! Voc√™ vai melhorar!';
      }
      
      if (timeout) message = '‚è∞ Tempo esgotado! ' + message;
      document.getElementById('endMessage').textContent = message;

      const finalScore = correctAnswers * 10 + Math.max(0, timeLeft) * 2;
      
      // Send score to parent hub
      if (window.parent !== window) {
        window.parent.postMessage({ type: 'game-score', game: 'ortografia', score: finalScore }, '*');
      }
    }
  </script>
</body>
</html>

