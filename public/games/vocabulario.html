<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>üß† Miss√£o Vocabul√°rio</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,sans-serif;background:#0b1220;color:#e2e8f0;min-height:100dvh;display:flex;justify-content:center}
    .app{width:min(720px,100%);padding:18px}
    .card{background:#111a2c;border:1px solid #24324d;border-radius:18px;padding:16px}
    h1{font-size:1.35rem;margin-bottom:4px}
    .muted{color:#93a4c2;font-size:.9rem}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .pill{background:#1a2740;border:1px solid #2c3b58;border-radius:999px;padding:6px 10px;font-size:.85rem}
    .scene{margin-top:14px;background:linear-gradient(135deg,#0f172a,#1e293b);border:1px solid #334155;border-radius:16px;padding:20px;text-align:center}
    .scene-emoji{font-size:4rem;line-height:1}
    .scene-text{margin-top:10px;font-size:1rem}
    .question{margin-top:14px;font-size:1.02rem;font-weight:700}
    .options{display:grid;grid-template-columns:1fr;gap:10px;margin-top:14px}
    button.opt{background:#17233a;border:1px solid #2e3f5f;color:#e2e8f0;padding:12px;border-radius:12px;font-size:1rem;font-weight:700;cursor:pointer}
    button.opt:hover{background:#1f2d4a}
    button.opt:active{transform:scale(.98)}
    .ok{border-color:#22c55e !important;background:#123524 !important}
    .bad{border-color:#ef4444 !important;background:#3a1b23 !important}
    .next{margin-top:14px;width:100%;background:#22d3ee;color:#03202a;border:none;padding:12px;border-radius:12px;font-size:1rem;font-weight:800;cursor:pointer}
    .center{text-align:center}
  </style>
</head>
<body>
  <div class="app">
    <div class="card" id="game">
      <h1>üß† Miss√£o Vocabul√°rio</h1>
      <div class="muted">Ingl√™s 8+ ‚Ä¢ palavras do cotidiano com contexto visual</div>
      <div class="row">
        <div class="pill">Pergunta: <span id="qnum">1</span>/12</div>
        <div class="pill">Pontos: <span id="score">0</span></div>
        <div class="pill">Tempo: <span id="time">120</span>s</div>
      </div>

      <div class="scene">
        <div class="scene-emoji" id="emoji">üçé</div>
        <div class="scene-text" id="sceneText">Voc√™ est√° no mercado vendo uma fruta.</div>
      </div>

      <div class="question" id="question">Qual √© a palavra em ingl√™s?</div>
      <div class="options" id="options"></div>
      <button class="next" id="nextBtn" style="display:none">Pr√≥xima ‚ñ∂</button>
    </div>
  </div>

  <script>
    const BANK = [
      {emoji:'üçé', scene:'Voc√™ est√° no mercado vendo uma fruta.', pt:'ma√ß√£', en:'apple', options:['apple','house','chair','school']},
      {emoji:'üè†', scene:'Voc√™ chegou em casa depois da escola.', pt:'casa', en:'house', options:['street','house','book','water']},
      {emoji:'üìò', scene:'Hora da leitura na sala.', pt:'livro', en:'book', options:['teacher','book','door','window']},
      {emoji:'üö™', scene:'Bata antes de entrar na sala.', pt:'porta', en:'door', options:['door','table','car','phone']},
      {emoji:'üíß', scene:'Voc√™ est√° com sede no recreio.', pt:'√°gua', en:'water', options:['milk','water','bread','shoe']},
      {emoji:'üçû', scene:'Caf√© da manh√£ na cozinha.', pt:'p√£o', en:'bread', options:['bread','rice','apple','fork']},
      {emoji:'üöó', scene:'Seu pai saiu de manh√£ para trabalhar.', pt:'carro', en:'car', options:['bus','car','bike','street']},
      {emoji:'ü™ë', scene:'Sente-se para come√ßar a aula.', pt:'cadeira', en:'chair', options:['chair','board','pencil','teacher']},
      {emoji:'üë©‚Äçüè´', scene:'Ela explica a mat√©ria na frente da turma.', pt:'professora', en:'teacher', options:['student','teacher','mother','doctor']},
      {emoji:'üßí', scene:'Quem est√° aprendendo na escola?', pt:'aluno', en:'student', options:['student','driver','teacher','friend']},
      {emoji:'üõ£Ô∏è', scene:'Voc√™ anda por ela para chegar na escola.', pt:'rua', en:'street', options:['street','home','notebook','water']},
      {emoji:'üè´', scene:'Lugar onde voc√™ estuda.', pt:'escola', en:'school', options:['school','market','hospital','park']},
      {emoji:'ü™ü', scene:'Abra para entrar luz na sala.', pt:'janela', en:'window', options:['window','door','floor','lamp']},
      {emoji:'üßë‚Äç‚öïÔ∏è', scene:'Pessoa que cuida da sa√∫de no hospital.', pt:'m√©dico', en:'doctor', options:['doctor','teacher','cook','driver']},
      {emoji:'üë©', scene:'Ela √© sua m√£e.', pt:'m√£e', en:'mother', options:['mother','sister','teacher','friend']},
      {emoji:'üëü', scene:'Cal√ßado para correr na quadra.', pt:'sapato', en:'shoe', options:['sock','shoe','pants','hat']},
      {emoji:'üçö', scene:'Comida comum no almo√ßo brasileiro.', pt:'arroz', en:'rice', options:['rice','beans','bread','milk']},
      {emoji:'üç¥', scene:'Use isso para comer macarr√£o.', pt:'garfo', en:'fork', options:['fork','spoon','knife','plate']},
      {emoji:'üöå', scene:'Transporte coletivo da cidade.', pt:'√¥nibus', en:'bus', options:['car','bus','bike','train']},
      {emoji:'üö≤', scene:'Ve√≠culo de duas rodas sem motor.', pt:'bicicleta', en:'bike', options:['bike','car','boat','plane']},
      {emoji:'üìã', scene:'A professora escreve nisso para aula.', pt:'quadro', en:'board', options:['board','window','book','pen']},
      {emoji:'‚úèÔ∏è', scene:'Objeto usado para escrever no caderno.', pt:'l√°pis', en:'pencil', options:['pencil','eraser','desk','chair']},
      {emoji:'üë®‚Äç‚úàÔ∏è', scene:'Pessoa que dirige um avi√£o.', pt:'piloto', en:'pilot', options:['pilot','driver','doctor','chef']},
      {emoji:'üç≤', scene:'Pessoa que prepara comida no restaurante.', pt:'cozinheiro', en:'cook', options:['cook','teacher','doctor','pilot']},
      {emoji:'üßë‚Äçü§ù‚Äçüßë', scene:'Pessoa com quem voc√™ brinca e conversa.', pt:'amigo', en:'friend', options:['friend','teacher','mother','driver']},
      {emoji:'üöÜ', scene:'Transporte sobre trilhos.', pt:'trem', en:'train', options:['train','boat','bus','bike']},
      {emoji:'üß¶', scene:'Voc√™ usa com t√™nis no p√©.', pt:'meia', en:'sock', options:['sock','shoe','shirt','hat']},
      {emoji:'üëñ', scene:'Roupa para as pernas.', pt:'cal√ßa', en:'pants', options:['pants','shirt','shoe','hat']},
      {emoji:'üß¢', scene:'Acess√≥rio para proteger do sol na cabe√ßa.', pt:'bon√©', en:'hat', options:['hat','bag','sock','shoe']},
      {emoji:'üõ∂', scene:'Transporte na √°gua, pequeno e simples.', pt:'barco', en:'boat', options:['boat','plane','car','train']},
      {emoji:'‚úàÔ∏è', scene:'Meio de transporte para viagens longas no c√©u.', pt:'avi√£o', en:'plane', options:['plane','boat','bus','bike']}
    ];

    let questions = [];
    let index = 0;
    let score = 0;
    let locked = false;
    let timeLeft = 120;
    let timer = null;
    const TOTAL_QUESTIONS = 12;

    const qnum = document.getElementById('qnum');
    const scoreEl = document.getElementById('score');
    const emojiEl = document.getElementById('emoji');
    const sceneText = document.getElementById('sceneText');
    const questionEl = document.getElementById('question');
    const optionsEl = document.getElementById('options');
    const nextBtn = document.getElementById('nextBtn');
    const game = document.getElementById('game');
    const timeEl = document.getElementById('time');

    function shuffle(arr){ return [...arr].sort(() => Math.random() - 0.5); }

    function start(){
      questions = shuffle(BANK).slice(0,TOTAL_QUESTIONS).map(q => ({...q, options: shuffle(q.options)}));
      index = 0; score = 0; locked = false;
      timeLeft = 120;
      timeEl.textContent = timeLeft;
      if (timer) clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        timeEl.textContent = Math.max(0, timeLeft);
        if (timeLeft <= 0) finish(true);
      }, 1000);
      render();
    }

    function render(){
      const q = questions[index];
      qnum.textContent = index + 1;
      scoreEl.textContent = score;
      emojiEl.textContent = q.emoji;
      sceneText.textContent = q.scene;
      questionEl.textContent = `"${q.pt}" em ingl√™s √©:`;
      optionsEl.innerHTML = '';
      nextBtn.style.display = 'none';
      locked = false;

      q.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'opt';
        btn.textContent = opt;
        btn.onclick = () => answer(btn, opt, q.en);
        optionsEl.appendChild(btn);
      });
    }

    function answer(btn, chosen, correct){
      if(locked) return;
      locked = true;
      const all = [...document.querySelectorAll('.opt')];
      all.forEach(b => b.disabled = true);

      if(chosen === correct){
        btn.classList.add('ok');
        score += 10;
        scoreEl.textContent = score;
      } else {
        btn.classList.add('bad');
        const right = all.find(b => b.textContent === correct);
        if(right) right.classList.add('ok');
      }

      nextBtn.style.display = 'block';
    }

    nextBtn.onclick = () => {
      index++;
      if(index >= questions.length){
        finish(false);
      } else {
        render();
      }
    };

    function finish(timeout=false){
      if (timer) { clearInterval(timer); timer = null; }
      const timeBonus = Math.max(0, timeLeft) * 2;
      const finalScore = score + timeBonus;
      game.innerHTML = `
        <div class="center">
          <h1>üéâ Miss√£o completa!</h1>
          <p class="muted" style="margin-top:8px">${timeout ? '‚è∞ Tempo esgotado!' : 'Mandou bem no vocabul√°rio do dia a dia.'}</p>
          <div class="scene" style="margin-top:16px">
            <div class="scene-emoji">üèÜ</div>
            <div class="scene-text">Base: <strong>${score}</strong> ‚Ä¢ B√¥nus de tempo: <strong>${timeBonus}</strong><br/>Pontua√ß√£o final: <strong>${finalScore}</strong></div>
          </div>
          <button class="next" style="margin-top:16px" onclick="location.reload()">Jogar de novo</button>
        </div>
      `;

      try {
        window.parent.postMessage({ type: 'game-score', game: 'vocabulario', score: finalScore }, '*');
      } catch (e) {
        console.warn('Falha ao enviar score', e);
      }
    }

    start();
  </script>
</body>
</html>
