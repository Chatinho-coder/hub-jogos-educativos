<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üåç GeoMestre Mundo</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,sans-serif;background:#0b1220;color:#e2e8f0;display:flex;justify-content:center;min-height:100dvh}
    .app{width:min(850px,100%);padding:18px}.card{background:#111a2c;border:1px solid #24324d;border-radius:18px;padding:16px}
    h1{font-size:1.35rem}.muted{color:#93a4c2;font-size:.9rem;margin-top:4px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}.pill{background:#1a2740;border:1px solid #2c3b58;border-radius:999px;padding:6px 10px;font-size:.85rem}
    .question{margin-top:14px;font-size:1.05rem;font-weight:700}
    .options{display:grid;gap:10px;margin-top:12px}
    .opt{background:#17233a;border:1px solid #2e3f5f;color:#e2e8f0;padding:12px;border-radius:10px;text-align:left;font-weight:700;cursor:pointer}
    .opt:hover{background:#1f2d4a}.ok{background:#123524;border-color:#22c55e}.bad{background:#3a1b23;border-color:#ef4444}
    .feedback{margin-top:10px;color:#bbf7d0;font-size:.92rem;line-height:1.45}
    .next{margin-top:12px;width:100%;padding:12px;border:0;border-radius:10px;background:#22c55e;color:#062812;font-weight:800;cursor:pointer}
    .hidden{display:none!important}.result{text-align:center;padding:22px 0}.score{font-size:2.3rem;font-weight:800;color:#86efac;margin-top:8px}
  </style>
</head>
<body>
<div class="app"><div class="card" id="gameCard">
  <h1>üåç GeoMestre Mundo</h1>
  <p class="muted">Geografia 9+ ‚Ä¢ pa√≠ses e capitais</p>
  <div class="row">
    <div class="pill">Pergunta: <span id="qnum">1</span>/<span id="qtotal">15</span></div>
    <div class="pill">Pontos: <span id="score">0</span></div>
    <div class="pill">Tempo: <span id="time">180</span>s</div>
  </div>

  <div class="question" id="question"></div>
  <div class="options" id="options"></div>
  <div class="feedback" id="feedback"></div>
  <button class="next hidden" id="nextBtn">Pr√≥xima ‚ñ∂</button>
</div></div>

<script>
const BANK = [
  ['Brasil','Bras√≠lia'],['Argentina','Buenos Aires'],['Chile','Santiago'],['Uruguai','Montevid√©u'],['Paraguai','Assun√ß√£o'],['Bol√≠via','Sucre'],['Peru','Lima'],['Equador','Quito'],['Col√¥mbia','Bogot√°'],['Venezuela','Caracas'],
  ['M√©xico','Cidade do M√©xico'],['Estados Unidos','Washington, D.C.'],['Canad√°','Ottawa'],['Cuba','Havana'],['Espanha','Madri'],['Portugal','Lisboa'],['Fran√ßa','Paris'],['It√°lia','Roma'],['Alemanha','Berlim'],['Reino Unido','Londres'],
  ['Irlanda','Dublin'],['Pa√≠ses Baixos','Amsterd√£'],['B√©lgica','Bruxelas'],['Su√≠√ßa','Berna'],['√Åustria','Viena'],['Pol√¥nia','Vars√≥via'],['Su√©cia','Estocolmo'],['Noruega','Oslo'],['Dinamarca','Copenhague'],['Finl√¢ndia','Helsinque'],
  ['Gr√©cia','Atenas'],['Turquia','Ancara'],['R√∫ssia','Moscou'],['Ucr√¢nia','Kiev'],['Jap√£o','T√≥quio'],['China','Pequim'],['Coreia do Sul','Seul'],['√çndia','Nova D√©lhi'],['Austr√°lia','Camberra'],['Nova Zel√¢ndia','Wellington'],
  ['Egito','Cairo'],['√Åfrica do Sul','Pret√≥ria'],['Nig√©ria','Abuja'],['Qu√™nia','Nair√≥bi'],['Marrocos','Rabat'],['Ar√°bia Saudita','Riade'],['Emirados √Årabes Unidos','Abu Dhabi'],['Israel','Jerusal√©m'],['Tail√¢ndia','Bangcoc'],['Vietn√£','Han√≥i']
];
const TOTAL=15;
const shuffle=a=>[...a].sort(()=>Math.random()-0.5);
const pick=(arr,n)=>shuffle(arr).slice(0,n);

let questions=[],i=0,score=0,time=180,lock=false,timer;
const $=id=>document.getElementById(id);

function makeQuestion(){
  const [country,capital]=BANK[Math.floor(Math.random()*BANK.length)];
  const askCapital = Math.random() < 0.5;
  if(askCapital){
    const wrong = pick(BANK.filter(x=>x[1]!==capital).map(x=>x[1]),3);
    const opts = shuffle([capital,...wrong]);
    return {q:`Qual √© a capital de ${country}?`,opts,ans:opts.indexOf(capital),exp:`${country} ‚Üí ${capital}.`};
  }
  const wrong = pick(BANK.filter(x=>x[0]!==country).map(x=>x[0]),3);
  const opts = shuffle([country,...wrong]);
  return {q:`${capital} √© capital de qual pa√≠s?`,opts,ans:opts.indexOf(country),exp:`${capital} √© a capital de ${country}.`};
}

function setup(){
  questions=[];
  while(questions.length<TOTAL) questions.push(makeQuestion());
  i=0;score=0;time=180;lock=false;
  $('score').textContent='0';$('time').textContent='180';
  clearInterval(timer);
  timer=setInterval(()=>{ time--; $('time').textContent=Math.max(0,time); if(time<=0) finish(); },1000);
  render();
}

function render(){
  const cur=questions[i];
  $('qnum').textContent=i+1; $('qtotal').textContent=questions.length;
  $('question').textContent=cur.q; $('feedback').textContent=''; $('nextBtn').classList.add('hidden');
  const box=$('options'); box.innerHTML=''; lock=false;
  cur.opts.forEach((opt,idx)=>{ const b=document.createElement('button'); b.className='opt'; b.textContent=opt; b.onclick=()=>answer(idx); box.appendChild(b); });
}

function answer(idx){
  if(lock) return; lock=true;
  const cur=questions[i], btns=$('options').children;
  if(idx===cur.ans){ btns[idx].classList.add('ok'); score+=10; $('score').textContent=score; $('feedback').textContent='‚úÖ '+cur.exp; }
  else { btns[idx].classList.add('bad'); btns[cur.ans].classList.add('ok'); $('feedback').textContent='‚ùå '+cur.exp; }
  $('nextBtn').classList.remove('hidden');
  if(i===questions.length-1) $('nextBtn').textContent='Finalizar üèÅ';
}

function next(){ if(i<questions.length-1){ i++; render(); } else finish(); }

function finish(){
  clearInterval(timer);
  const final=score+Math.max(0,time);
  $('gameCard').innerHTML=`<div class='result'><h1>üèÜ Miss√£o conclu√≠da</h1><p class='muted' style='margin-top:8px'>GeoMestre Mundo finalizado!</p><div class='score'>${final} pontos</div><p class='muted' style='margin-top:8px'>Base: ${score} ‚Ä¢ b√¥nus tempo: ${Math.max(0,time)}</p><button class='next' style='margin-top:14px' onclick='location.reload()'>Jogar novamente</button></div>`;
  window.parent.postMessage({type:'game-score',game:'geomaster-mundo',score:final},'*');
}

$('nextBtn').onclick=next;
setup();
</script>
</body>
</html>